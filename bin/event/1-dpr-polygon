#!/usr/bin/env bash

set -e

p() { printf "%-66s %-66s\n" "$1" "$2"; }

locs=(
60,2
33,-17
64,-17
49,9
38,-3
  )

addrs=(
0x0787391e5Bca02da1B9902B801d57b5a1d662BCa
0xd5332E20970EdA1549BdC5AAa6e1Aa8857d264fA
0xB287aa380013B1d89279E8cC73C97a65d5543894
0xCDD7E27abBF54D2626c49c21FbdEE6dAb394b416
0x69716bb8879D2f4E56e05b37f957B7F3Bf39e26d
  )

export SETH_ASYNC=yes
chain=polygon
from=0x7aE77149ed38c5dD313e9069d790Ce7085caf0A6
nonce=$(seth nonce $from --chain $chain)
echo "nonce: ${nonce}"
# claim land from genesis holder
for loc in "${locs[@]}"; do
  locarray=(`echo $loc | tr ',' ' '`)
  x="${locarray[0]}"
  y="${locarray[1]}"
  echo $x $y
  unset ETH_NONCE
  landId=$(evo lnd-bas loc $(seth --to-int256 $x) $(seth --to-int256 $y) --chain $chain)
  echo $landId
  export ETH_NONCE=$nonce
  evo mkt-gen claim $landId --chain $chain
  nonce=$(( ${nonce} + 1 ))
  # evo cmn-tkn owner $landId --chain $chain
  # evo lnd-mst unbox $landId --chain $chain
done
echo "nonce: ${nonce}"

echo "------------------------------------------------------------------"

echo "nonce: ${nonce}"
for (( i=0; i<${#locs[@]}; i++ ));
do
  loc="${locs[$i]}"
  to="${addrs[$i]}"
  locarray=(`echo $loc | tr ',' ' '`)
  x="${locarray[0]}"
  y="${locarray[1]}"
  echo $x $y
  unset ETH_NONCE
  landId=$(evo lnd-bas loc $(seth --to-int256 $x) $(seth --to-int256 $y) --chain $chain)
  p "$landId" "$to"
  export ETH_NONCE=$nonce
  evo cmn-tkn transferFrom "$from" "$to" "$landId" --chain $chain
  nonce=$(( ${nonce} + 1 ))
done
echo "nonce: ${nonce}"
